using Models;
using System;
using System.Net;
using System.Net.Mail;
using System.Net.Security;
using System.Security.Cryptography.X509Certificates;
using System.Threading.Tasks;

namespace Notification_PI.NetHelper
{
    class SMTPAsync
    {
        public async Task<bool> SendMessage(string[] toMails, string[] ccMails, string[] bccMails,string subject,string body,User user)
        {
            return await Task.Run<bool>(
                () =>
                {
                    string htmlbody= " <html>\r\n<head>\r\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=us-ascii\">\r\n<meta name=\"Generator\" content=\"Microsoft Word 15 (filtered medium)\">\r\n<style><!--\r\n/* Font Definitions */\r\n@font-face\r\n\t{font-family:\"Cambria Math\";\r\n\tpanose-1:2 4 5 3 5 4 6 3 2 4;}\r\n@font-face\r\n\t{font-family:Calibri;\r\n\tpanose-1:2 15 5 2 2 2 4 3 2 4;}\r\n@font-face\r\n\t{font-family:Verdana;\r\n\tpanose-1:2 11 6 4 3 5 4 4 2 4;}\r\n/* Style Definitions */\r\np.MsoNormal, li.MsoNormal, div.MsoNormal\r\n\t{margin:0in;\r\n\tmargin-bottom:.0001pt;\r\n\tfont-size:12.0pt;\r\n\tfont-family:\"Times New Roman\",serif;}\r\na:link, span.MsoHyperlink\r\n\t{mso-style-priority:99;\r\n\tcolor:blue;\r\n\ttext-decoration:underline;}\r\na:visited, span.MsoHyperlinkFollowed\r\n\t{mso-style-priority:99;\r\n\tcolor:purple;\r\n\ttext-decoration:underline;}\r\np\r\n\t{mso-style-priority:99;\r\n\tmargin:0in;\r\n\tmargin-bottom:.0001pt;\r\n\tfont-size:12.0pt;\r\n\tfont-family:\"Times New Roman\",serif;}\r\nspan.EmailStyle18\r\n\t{mso-style-type:personal;\r\n\tfont-family:\"Calibri\",sans-serif;\r\n\tcolor:#1F497D;}\r\nspan.EmailStyle19\r\n\t{mso-style-type:personal;\r\n\tfont-family:\"Calibri\",sans-serif;\r\n\tcolor:windowtext;}\r\nspan.EmailStyle20\r\n\t{mso-style-type:personal;\r\n\tfont-family:\"Calibri\",sans-serif;\r\n\tcolor:#1F497D;}\r\nspan.EmailStyle21\r\n\t{mso-style-type:personal;\r\n\tfont-family:\"Calibri\",sans-serif;\r\n\tcolor:windowtext;}\r\nspan.EmailStyle22\r\n\t{mso-style-type:personal;\r\n\tfont-family:\"Calibri\",sans-serif;\r\n\tcolor:#1F497D;}\r\nspan.EmailStyle23\r\n\t{mso-style-type:personal;\r\n\tfont-family:\"Calibri\",sans-serif;\r\n\tcolor:windowtext;}\r\nspan.EmailStyle24\r\n\t{mso-style-type:personal;\r\n\tfont-family:\"Calibri\",sans-serif;\r\n\tcolor:#1F497D;}\r\nspan.EmailStyle25\r\n\t{mso-style-type:personal;\r\n\tfont-family:\"Calibri\",sans-serif;\r\n\tcolor:windowtext;}\r\nspan.EmailStyle26\r\n\t{mso-style-type:personal;\r\n\tfont-family:\"Calibri\",sans-serif;\r\n\tcolor:#1F497D;}\r\nspan.EmailStyle27\r\n\t{mso-style-type:personal;\r\n\tfont-family:\"Calibri\",sans-serif;\r\n\tcolor:windowtext;}\r\nspan.EmailStyle28\r\n\t{mso-style-type:personal;\r\n\tfont-family:\"Calibri\",sans-serif;\r\n\tcolor:#1F497D;}\r\nspan.EmailStyle29\r\n\t{mso-style-type:personal;\r\n\tfont-family:\"Calibri\",sans-serif;\r\n\tcolor:windowtext;}\r\nspan.EmailStyle30\r\n\t{mso-style-type:personal;\r\n\tfont-family:\"Calibri\",sans-serif;\r\n\tcolor:#1F497D;}\r\nspan.EmailStyle31\r\n\t{mso-style-type:personal;\r\n\tfont-family:\"Calibri\",sans-serif;\r\n\tcolor:windowtext;}\r\nspan.EmailStyle32\r\n\t{mso-style-type:personal;\r\n\tfont-family:\"Calibri\",sans-serif;\r\n\tcolor:#1F497D;}\r\nspan.EmailStyle33\r\n\t{mso-style-type:personal;\r\n\tfont-family:\"Calibri\",sans-serif;\r\n\tcolor:windowtext;}\r\nspan.EmailStyle34\r\n\t{mso-style-type:personal;\r\n\tfont-family:\"Calibri\",sans-serif;\r\n\tcolor:#1F497D;}\r\nspan.EmailStyle35\r\n\t{mso-style-type:personal;\r\n\tfont-family:\"Calibri\",sans-serif;\r\n\tcolor:windowtext;}\r\nspan.EmailStyle36\r\n\t{mso-style-type:personal;\r\n\tfont-family:\"Calibri\",sans-serif;\r\n\tcolor:#1F497D;}\r\nspan.EmailStyle37\r\n\t{mso-style-type:personal;\r\n\tfont-family:\"Calibri\",sans-serif;\r\n\tcolor:windowtext;}\r\nspan.EmailStyle38\r\n\t{mso-style-type:personal;\r\n\tfont-family:\"Calibri\",sans-serif;\r\n\tcolor:#1F497D;}\r\nspan.EmailStyle39\r\n\t{mso-style-type:personal;\r\n\tfont-family:\"Calibri\",sans-serif;\r\n\tcolor:windowtext;}\r\nspan.EmailStyle40\r\n\t{mso-style-type:personal;\r\n\tfont-family:\"Calibri\",sans-serif;\r\n\tcolor:#1F497D;}\r\nspan.EmailStyle41\r\n\t{mso-style-type:personal;\r\n\tfont-family:\"Calibri\",sans-serif;\r\n\tcolor:windowtext;}\r\nspan.EmailStyle42\r\n\t{mso-style-type:personal;\r\n\tfont-family:\"Calibri\",sans-serif;\r\n\tcolor:#1F497D;}\r\nspan.EmailStyle43\r\n\t{mso-style-type:personal;\r\n\tfont-family:\"Calibri\",sans-serif;\r\n\tcolor:windowtext;}\r\nspan.EmailStyle44\r\n\t{mso-style-type:personal;\r\n\tfont-family:\"Calibri\",sans-serif;\r\n\tcolor:#1F497D;}\r\nspan.EmailStyle45\r\n\t{mso-style-type:personal;\r\n\tfont-family:\"Calibri\",sans-serif;\r\n\tcolor:windowtext;}\r\nspan.EmailStyle46\r\n\t{mso-style-type:personal;\r\n\tfont-family:\"Calibri\",sans-serif;\r\n\tcolor:#1F497D;}\r\nspan.EmailStyle47\r\n\t{mso-style-type:personal;\r\n\tfont-family:\"Calibri\",sans-serif;\r\n\tcolor:windowtext;}\r\nspan.EmailStyle48\r\n\t{mso-style-type:personal;\r\n\tfont-family:\"Calibri\",sans-serif;\r\n\tcolor:#1F497D;}\r\nspan.EmailStyle49\r\n\t{mso-style-type:personal-compose;\r\n\tfont-family:\"Calibri\",sans-serif;\r\n\tcolor:windowtext;}\r\n.MsoChpDefault\r\n\t{mso-style-type:export-only;\r\n\tfont-size:10.0pt;}\r\n@page WordSection1\r\n\t{size:8.5in 11.0in;\r\n\tmargin:1.0in 1.0in 1.0in 1.0in;}\r\ndiv.WordSection1\r\n\t{page:WordSection1;}\r\n--></style><!--[if gte mso 9]><xml>\r\n<o:shapedefaults v:ext=\"edit\" spidmax=\"1026\" />\r\n</xml><![endif]--><!--[if gte mso 9]><xml>\r\n<o:shapelayout v:ext=\"edit\">\r\n<o:idmap v:ext=\"edit\" data=\"1\" />\r\n</o:shapelayout></xml><![endif]-->\r\n</head>\r\n<body lang=\"EN-US\" link=\"blue\" vlink=\"purple\">\r\n<div class=\"WordSection1\">\r\n<p class=\"MsoNormal\"><span style=\"font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif;color:#1F497D\"><o:p>&nbsp;</o:p></span></p>\r\n<p class=\"MsoNormal\"><span style=\"font-family:&quot;Calibri&quot;,sans-serif\">Hello Everyone,<o:p></o:p></span></p>\r\n<p class=\"MsoNormal\"><span style=\"font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif\"><o:p>&nbsp;</o:p></span></p>\r\n<p><span style=\"font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif\">Deployment for the\r\n<span style=\"color:black\">change Id 831</span> has been completed successfully, testing team please proceed with the smoke test and confirm the status once done.<o:p></o:p></span></p>\r\n<p class=\"MsoNormal\"><span style=\"font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif\"><o:p>&nbsp;</o:p></span></p>\r\n<table class=\"MsoNormalTable\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"78%\" style=\"width:78.0%;border-collapse:collapse\">\r\n<tbody>\r\n<tr style=\"height:6.0pt\">\r\n<td width=\"518\" style=\"width:388.85pt;border:ridge black 2.25pt;background:#D9E2F3;padding:0in 0in 0in 0in;height:6.0pt\">\r\n<p class=\"MsoNormal\"><b><span style=\"font-size:10.0pt;font-family:&quot;Verdana&quot;,sans-serif\">SIMPLIFICATION Business Release 6</span></b><span style=\"font-size:11.5pt;font-family:&quot;Calibri&quot;,sans-serif\"><o:p></o:p></span></p>\r\n</td>\r\n<td width=\"503\" valign=\"top\" style=\"width:377.45pt;border:ridge black 2.25pt;border-left:none;background:#D9E2F3;padding:0in 0in 0in 0in;height:6.0pt\">\r\n<p class=\"MsoNormal\"><span style=\"font-size:10.0pt;font-family:&quot;Verdana&quot;,sans-serif\">&nbsp;</span><span style=\"font-size:11.5pt;font-family:&quot;Calibri&quot;,sans-serif\"><o:p></o:p></span></p>\r\n</td>\r\n</tr>\r\n<tr style=\"height:6.0pt\">\r\n<td width=\"518\" style=\"width:388.85pt;border:ridge black 2.25pt;border-top:none;background:#D0CECE;padding:0in 0in 0in 0in;height:6.0pt\">\r\n<p class=\"MsoNormal\"><b><span style=\"font-size:10.0pt;font-family:&quot;Verdana&quot;,sans-serif\">SIMPLIFICATION &#8211; SIT 2 - Deployment</span></b><span style=\"font-size:11.5pt;font-family:&quot;Calibri&quot;,sans-serif\"><o:p></o:p></span></p>\r\n</td>\r\n<td width=\"503\" valign=\"top\" style=\"width:377.45pt;border-top:none;border-left:none;border-bottom:ridge black 2.25pt;border-right:ridge black 2.25pt;background:#D0CECE;padding:0in 0in 0in 0in;height:6.0pt\">\r\n<p class=\"MsoNormal\"><span style=\"font-size:10.0pt;font-family:&quot;Verdana&quot;,sans-serif;color:white\">&nbsp;</span><span style=\"font-size:11.5pt;font-family:&quot;Calibri&quot;,sans-serif\"><o:p></o:p></span></p>\r\n</td>\r\n</tr>\r\n<tr style=\"height:6.0pt\">\r\n<td width=\"518\" valign=\"top\" style=\"width:388.85pt;border:ridge black 2.25pt;border-top:none;padding:0in 0in 0in 0in;height:6.0pt\">\r\n<p class=\"MsoNormal\"><span style=\"color:#004080\">&nbsp;</span><b><span style=\"font-size:10.0pt;color:#004080\"><br>\r\nDATE of Deployment :</span></b>&nbsp;05<span style=\"font-size:10.0pt\">/04/2017</span><span style=\"color:#004080\"><br>\r\n&nbsp;</span><b><span style=\"font-size:10.0pt;color:#004080\"><br>\r\nStart time :</span></b><span style=\"font-size:10.0pt;color:#004080\">&nbsp;</span>05<span style=\"font-size:10.0pt\">/04/2017&nbsp;\r\n<span style=\"color:#212121\">1</span>5<span style=\"color:#212121\">0</span>0hrs &nbsp;CEST<br>\r\n</span><span style=\"color:#004080\">&nbsp;</span><b><span style=\"font-size:10.0pt;color:#004080\"><br>\r\nEstimated end time</span><span style=\"color:#004080\">&nbsp;:</span></b><span style=\"font-size:10.0pt;color:black\">&nbsp;</span>05<span style=\"font-size:10.0pt\">/04/2017&nbsp;1600hrs &nbsp;CEST<br>\r\n</span><span style=\"color:#004080\">&nbsp;</span><b><span style=\"font-size:10.0pt;color:#004080\"><br>\r\nApplication(s)</span></b><span style=\"color:#004080\">&nbsp;</span><span style=\"font-size:10.0pt\">:&nbsp;&nbsp;</span><a href=\"http://team.apmoller.net/sites/simplification/tda/Lists/SIM%20Applications/DispForm.aspx?ID=87&amp;RootFolder=*\" target=\"_blank\" title=\"http://team.apmoller.net/sites/simplification/tda/Lists/SIM%20Applications/DispForm.aspx?ID=87&amp;amp;RootFolder=*\nCtrl&#43;Click or tap to follow the link\"><span style=\"font-size:8.0pt;font-family:&quot;Verdana&quot;,sans-serif\">ODS\r\n (Operational Data Store)</span><span style=\"font-size:8.0pt;font-family:&quot;Verdana&quot;,sans-serif;color:#17365D\">&nbsp;</span></a><span style=\"font-size:10.0pt\"><br>\r\n</span><b>&nbsp;</b><b><span style=\"font-size:10.0pt;color:#004080\"><br>\r\nHigh Level summary of deployment</span></b>&nbsp;<br>\r\n<span style=\"font-size:10.0pt\">Change ID 831</span><span style=\"font-size:11.5pt;font-family:&quot;Calibri&quot;,sans-serif\"><o:p></o:p></span></p>\r\n<p class=\"MsoNormal\"><span style=\"font-size:8.0pt;font-family:&quot;Verdana&quot;,sans-serif\">PR-3037:SIM - BR6 - Operational Data Store<o:p></o:p></span></p>\r\n<p class=\"MsoNormal\"><span style=\"font-size:8.0pt;font-family:&quot;Verdana&quot;,sans-serif\"><o:p>&nbsp;</o:p></span></p>\r\n<p class=\"MsoNormal\"><span style=\"font-size:10.0pt\">Components:</span><span style=\"font-size:11.5pt;font-family:&quot;Calibri&quot;,sans-serif\"><o:p></o:p></span></p>\r\n<p class=\"MsoNormal\" style=\"text-indent:-.25in\"><span style=\"font-size:8.0pt;font-family:Symbol;color:black\">&middot;</span><span style=\"font-size:7.0pt;color:black\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href=\"http://team.apmoller.net/sites/simplification/tda/Lists/SIM%20Applications/DispForm.aspx?ID=10&amp;RootFolder=*\" target=\"_blank\"><span style=\"font-size:8.0pt;font-family:&quot;Verdana&quot;,sans-serif\">ODS\r\n (Operational Data Store)</span></a><span style=\"font-size:11.5pt;font-family:&quot;Calibri&quot;,sans-serif\"><o:p></o:p></span></p>\r\n<p class=\"MsoNormal\"><span style=\"font-size:8.0pt;font-family:&quot;Verdana&quot;,sans-serif\"><o:p>&nbsp;</o:p></span></p>\r\n<p class=\"MsoNormal\" style=\"margin-bottom:12.0pt\"><b><span style=\"font-size:10.0pt;color:#004080\">Latest Updates</span></b><b><span style=\"font-size:10.0pt\">:\r\n<o:p></o:p></span></b></p>\r\n<p class=\"MsoNormal\" style=\"margin-bottom:12.0pt\"><span style=\"font-size:10.0pt\">The build shall be deployed at 1500hrs CEST<b><o:p></o:p></b></span></p>\r\n<p class=\"MsoNormal\"><span style=\"font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif\"><o:p>&nbsp;</o:p></span></p>\r\n<p><b><span style=\"font-size:10.0pt;color:#004080\">Deployment Updates:</span></b><b><span style=\"font-size:10.0pt\">\r\n<span style=\"color:#004080\">:</span> </span></b><i><span style=\"font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif\">Completed successfully.<span style=\"color:#212121\">&nbsp;</span></span></i><span style=\"font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif\"><o:p></o:p></span></p>\r\n<p class=\"MsoNormal\"><span style=\"font-size:11.5pt;font-family:&quot;Calibri&quot;,sans-serif\"><o:p>&nbsp;</o:p></span></p>\r\n<p class=\"MsoNormal\"><span style=\"font-size:11.5pt;font-family:&quot;Calibri&quot;,sans-serif\"><o:p>&nbsp;</o:p></span></p>\r\n<p class=\"MsoNormal\"><b><span style=\"font-size:10.0pt;color:#004080\">Open Issue:</span></b><span style=\"font-size:11.5pt;font-family:&quot;Calibri&quot;,sans-serif\"><o:p></o:p></span></p>\r\n<p class=\"MsoNormal\"><span style=\"font-size:10.0pt\">None</span><span style=\"font-size:11.5pt;font-family:&quot;Calibri&quot;,sans-serif\"><o:p></o:p></span></p>\r\n</td>\r\n<td width=\"503\" valign=\"top\" style=\"width:377.45pt;border-top:none;border-left:none;border-bottom:ridge black 2.25pt;border-right:ridge black 2.25pt;padding:0in 0in 0in 0in;height:6.0pt\">\r\n<p class=\"MsoNormal\" style=\"margin-bottom:12.0pt\"><span style=\"color:#004080\">&nbsp;</span>&nbsp;<br>\r\n<b><span style=\"font-size:10.0pt;color:#004080\">Contact Person(s)</span></b>&nbsp;<br>\r\n<b><span style=\"font-size:10.0pt;color:#004080\">Requester:&nbsp;</span></b><span style=\"font-size:11.5pt;font-family:&quot;Calibri&quot;,sans-serif\"><o:p></o:p></span></p>\r\n<p class=\"MsoNormal\"><span style=\"font-size:10.0pt\">Name</span><span style=\"font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif\">&nbsp;:&nbsp;</span><a href=\"mailto:Russell.Baker@maersk.com\"><span style=\"font-size:10.0pt;color:windowtext;text-decoration:none\">Russell Baker</span></a><span style=\"font-size:11.5pt;font-family:&quot;Calibri&quot;,sans-serif\"><o:p></o:p></span></p>\r\n<p class=\"MsoNormal\"><span style=\"font-size:10.0pt\">Email :</span><span style=\"font-size:8.0pt;font-family:&quot;Verdana&quot;,sans-serif;color:#17365D\">\r\n</span><a href=\"mailto:Russell.Baker@maersk.com\">Russell.Baker@maersk.com</a><span style=\"font-size:8.0pt;font-family:&quot;Verdana&quot;,sans-serif;color:#17365D\">\r\n<o:p></o:p></span></p>\r\n<p class=\"MsoNormal\"><span style=\"font-size:10.0pt\">Phone :</span><span style=\"font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif\">&nbsp;</span><span style=\"font-size:10.0pt\">Not Available</span><span style=\"font-size:11.5pt;font-family:&quot;Calibri&quot;,sans-serif\"><o:p></o:p></span></p>\r\n<p class=\"MsoNormal\"><span style=\"font-size:10.0pt\"><br>\r\n</span><span style=\"color:#004080\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><br>\r\n<b><span style=\"font-size:10.0pt;color:#004080\">Deployment team:</span></b><span style=\"font-size:11.5pt;font-family:&quot;Calibri&quot;,sans-serif\"><o:p></o:p></span></p>\r\n<p class=\"MsoNormal\"><span style=\"font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif\">&nbsp;</span><span style=\"font-size:11.5pt;font-family:&quot;Calibri&quot;,sans-serif\"><o:p></o:p></span></p>\r\n<p class=\"MsoNormal\"><span style=\"font-size:10.0pt\">Name: Rajat Sharma</span><span style=\"font-size:11.5pt;font-family:&quot;Calibri&quot;,sans-serif\"><o:p></o:p></span></p>\r\n<p class=\"MsoNormal\"><span style=\"font-size:10.0pt\">Email:&nbsp;</span><span style=\"font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif\">&nbsp;</span><span class=\"MsoHyperlink\"><a href=\"mailto:rajat.sharma@maersk.com\">rajat.sharma@maersk.com</a><o:p></o:p></span></p>\r\n<p class=\"MsoNormal\"><span style=\"font-size:10.0pt\">Phone: Not Available</span><span style=\"font-size:11.5pt;font-family:&quot;Calibri&quot;,sans-serif\"><o:p></o:p></span></p>\r\n<p class=\"MsoNormal\"><span style=\"font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif\">&nbsp;</span><span style=\"font-size:11.5pt;font-family:&quot;Calibri&quot;,sans-serif\"><o:p></o:p></span></p>\r\n<p class=\"MsoNormal\"><span style=\"font-size:10.0pt;color:#004080\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size:11.5pt;font-family:&quot;Calibri&quot;,sans-serif\"><o:p></o:p></span></p>\r\n<p class=\"MsoNormal\"><b><span style=\"font-size:10.0pt;color:#004080\">Testing team:</span></b><span style=\"font-size:11.5pt;font-family:&quot;Calibri&quot;,sans-serif\"><o:p></o:p></span></p>\r\n<p class=\"MsoNormal\">&nbsp;<span style=\"font-size:11.5pt;font-family:&quot;Calibri&quot;,sans-serif\"><o:p></o:p></span></p>\r\n<p class=\"MsoNormal\"><span style=\"font-size:10.0pt\">Name</span><span style=\"font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif\">&nbsp;:&nbsp;</span><a href=\"mailto:Russell.Baker@maersk.com\"><span style=\"font-size:10.0pt;color:windowtext;text-decoration:none\">Russell Baker</span></a><span style=\"font-size:11.5pt;font-family:&quot;Calibri&quot;,sans-serif\"><o:p></o:p></span></p>\r\n<p class=\"MsoNormal\"><span style=\"font-size:10.0pt\">Email :</span><span style=\"font-size:8.0pt;font-family:&quot;Verdana&quot;,sans-serif;color:#17365D\">\r\n</span><a href=\"mailto:Russell.Baker@maersk.com\">Russell.Baker@maersk.com</a><span style=\"font-size:8.0pt;font-family:&quot;Verdana&quot;,sans-serif;color:#17365D\">\r\n<o:p></o:p></span></p>\r\n<p class=\"MsoNormal\"><span style=\"font-size:10.0pt\">Phone :</span><span style=\"font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif\">&nbsp;</span><span style=\"font-size:10.0pt\">Not Available</span><span style=\"font-size:11.5pt;font-family:&quot;Calibri&quot;,sans-serif\"><o:p></o:p></span></p>\r\n<p class=\"MsoNormal\"><span style=\"font-size:11.5pt;font-family:&quot;Calibri&quot;,sans-serif\"><o:p>&nbsp;</o:p></span></p>\r\n<p class=\"MsoNormal\"><span style=\"font-size:11.5pt;font-family:&quot;Calibri&quot;,sans-serif\"><o:p>&nbsp;</o:p></span></p>\r\n<p class=\"MsoNormal\">&nbsp;<span style=\"font-size:11.5pt;font-family:&quot;Calibri&quot;,sans-serif\"><o:p></o:p></span></p>\r\n<p class=\"MsoNormal\"><span style=\"font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif\">&nbsp;</span><span style=\"font-size:11.5pt;font-family:&quot;Calibri&quot;,sans-serif\"><o:p></o:p></span></p>\r\n<p class=\"MsoNormal\"><b><span style=\"font-size:10.0pt;color:#004080\">&nbsp;</span></b><span style=\"font-size:11.5pt;font-family:&quot;Calibri&quot;,sans-serif\"><o:p></o:p></span></p>\r\n<p class=\"MsoNormal\">&nbsp;<span style=\"font-size:11.5pt;font-family:&quot;Calibri&quot;,sans-serif\"><o:p></o:p></span></p>\r\n<p class=\"MsoNormal\"><span style=\"font-size:10.0pt;color:#004080\">&nbsp;</span><span style=\"font-size:11.5pt;font-family:&quot;Calibri&quot;,sans-serif\"><o:p></o:p></span></p>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p class=\"MsoNormal\"><span style=\"font-family:&quot;Calibri&quot;,sans-serif;color:black\">&nbsp;</span><span style=\"font-size:11.5pt;font-family:&quot;Calibri&quot;,sans-serif;color:#212121\"><o:p></o:p></span></p>\r\n<p class=\"MsoNormal\"><span style=\"font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif;color:#212121\">&nbsp;</span><span style=\"font-size:11.5pt;font-family:&quot;Calibri&quot;,sans-serif;color:#212121\"><o:p></o:p></span></p>\r\n<p class=\"MsoNormal\"><span style=\"font-size:11.5pt;font-family:&quot;Calibri&quot;,sans-serif;color:#212121\">Thanks &amp; Regards&nbsp;</span><span style=\"font-size:11.5pt;font-family:&quot;Calibri&quot;,sans-serif\"><o:p></o:p></span></p>\r\n<p class=\"MsoNormal\"><span style=\"font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif\">Rajat Sharma<o:p></o:p></span></p>\r\n<p class=\"MsoNormal\"><span style=\"font-size:11.5pt;font-family:&quot;Calibri&quot;,sans-serif;color:#212121\">SIT2 Deployment Team<o:p></o:p></span></p>\r\n<p class=\"MsoNormal\"><span style=\"font-size:11.5pt;font-family:&quot;Calibri&quot;,sans-serif;color:#212121\">Tata Consultancy Services<o:p></o:p></span></p>\r\n<p class=\"MsoNormal\"><span style=\"font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif;color:#1F497D\"><o:p>&nbsp;</o:p></span></p>\r\n<p class=\"MsoNormal\"><span style=\"font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif;color:#1F497D\"><o:p>&nbsp;</o:p></span></p>\r\n</div>\r\n</body>\r\n</html>\r\n";
                    MailMessage mailMessage = new MailMessage();
                    NetworkCredential credentials = new NetworkCredential(user.Email, user.Password);

                    body = body == "" ? htmlbody : body;
                    subject = subject == "" ? "#AutomationTest" : subject;
                    mailMessage.From = new MailAddress(user.Email,user.Name);
                    mailMessage.Subject = subject;
                    mailMessage.Body = body;
                    foreach (var item in toMails)
                    {
                        mailMessage.To.Add(item);
                    }
                    foreach (var item in ccMails)
                    {
                        mailMessage.To.Add(item);
                    }
                    foreach (var item in bccMails)
                    {
                        mailMessage.To.Add(item);
                    }
                    SmtpClient smtpClient = new SmtpClient("webmail.maersk.com", 587);
                    mailMessage.IsBodyHtml = true;
                    
                    
                    smtpClient.DeliveryMethod = SmtpDeliveryMethod.Network;
                    
                    smtpClient.EnableSsl = true;
                    smtpClient.UseDefaultCredentials = false;
                    smtpClient.Credentials = credentials;
                    ServicePointManager.ServerCertificateValidationCallback =
                    delegate (object s, X509Certificate certificate,X509Chain chain, SslPolicyErrors sslPolicyErrors)
                            {
                                return true;
                            };
                    try
                    {
                        smtpClient.Send(mailMessage);
                    }
                    catch (Exception ex)
                    {
                        if(ex.InnerException != null)
                            throw ex.InnerException;
                        else
                            throw ex;
                    }
                        return true;
                }
                );
            
        }
    }
}
